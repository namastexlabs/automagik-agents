# Tools Refactoring Plan

## Completed Tasks
- [x] discord module (completed)
- [x] google_drive module (completed)
- [x] evolution module (completed)
- [x] notion module (completed)
- [x] Check for any remaining tools in the root directory

## Cleanup Tasks
- [x] Check for any tools in the root directory that need to be migrated
- [x] Ensure all tools have consistent file structure
- [x] Delete old files after migrating functionality
- [x] Clean up memory_tools directory (duplicate of memory)
- [x] Remove src/ subdirectory in tools (contains empty nested tool directories)
- [x] Remove common_tools directory
- [x] Fix SimpleAgent to use new tools structure instead of common_tools
- [x] Fix import errors (`discord_tools`, `google_drive_tools`, `evolution_tools`)
- [x] Fix circular dependency issues between SimpleAgent and memory tools

## Import Fixes
After the refactoring, we encountered import errors with the application startup. The issue was that we were trying to import names like `discord_tools` from the modules, but those names weren't defined in the modules. To fix this:

1. Added `discord_tools` list in `src/tools/discord/interface.py` 
2. Added `google_drive_tools` list in `src/tools/google_drive/interface.py`
3. Added `evolution_tools` list in `src/tools/evolution/interface.py`
4. Updated all three module __init__.py files to export these tool collections

## Circular Dependency Fixes
We also encountered circular dependency issues between SimpleAgent and the memory tools:

1. Modified SimpleAgent to use lazy imports for memory tools
2. Created a _import_memory_tools() function to handle imports only when needed
3. Updated src/tools/__init__.py to import directly from memory.tool instead of the memory package

All imports in `src/tools/__init__.py` now correctly match what's exported from each module.

## Findings

### Tools Directory Structure
We've successfully migrated all tools to a consistent modular structure:
- Each tool module (datetime, discord, evolution, google_drive, notion) follows the same pattern
- Each module has a clear separation of concerns (schema, tool implementation, interface)
- All unnecessary or duplicate directories have been removed

### Removed Directories
- `src/tools/memory_tools`: Older version with separate files for operations
- `src/tools/src/`: Unnecessary nested structure with empty directories
- `src/tools/common_tools/`: Not needed as datetime is now a standalone module

### SimpleAgent Integration
- Updated SimpleAgent to use the new tools directly instead of trying to access the old common_tools structure
- Fixed the datetime_tools import issue in src/tools/__init__.py
- Removed references to tools that no longer exist (web, image, audio, document) 
- Fixed the memory variable handling to work with the new memory tools
- Added lazy loading of memory tools to break circular dependencies

## Final Structure
The tools directory now has a clean, consistent structure:
- datetime/ - Datetime tools
- discord/ - Discord tools
- evolution/ - Evolution tools
- google_drive/ - Google Drive tools
- memory/ - Memory tools
- notion/ - Notion tools
- __init__.py - Main exports

Each module provides a consistent interface:
- Tool functions for direct use
- Schema models for type safety
- Tools collection for easier importing
- Compatibility classes for backward compatibility

## Next Steps
The refactoring is now complete. To ensure everything works properly:
1. Verify that all tools are exported correctly in the package __init__.py
2. Test each tool to ensure functionality is maintained
3. Update documentation to reflect the new structure 